function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,n=arguments[t];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var FUNC_ERROR_TEXT="Expected a function",NAN=NaN,symbolTag="[object Symbol]",reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt,freeGlobal="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),objectProto=Object.prototype,objectToString=objectProto.toString,nativeMax=Math.max,nativeMin=Math.min,now=function(){return root.Date.now()};function debounce(n,o,e){var r,i,a,l,s,u,c=0,f=!1,d=!1,t=!0;if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT);function b(e){var t=r,o=i;return r=i=void 0,c=e,l=n.apply(o,t)}function g(e){var t=e-u;return void 0===u||o<=t||t<0||d&&a<=e-c}function v(){var e,t=now();if(g(t))return p(t);s=setTimeout(v,(t=o-((e=t)-u),d?nativeMin(t,a-(e-c)):t))}function p(e){return s=void 0,t&&r?b(e):(r=i=void 0,l)}function m(){var e=now(),t=g(e);if(r=arguments,i=this,u=e,t){if(void 0===s)return c=t=u,s=setTimeout(v,o),f?b(t):l;if(d)return s=setTimeout(v,o),b(u)}return void 0===s&&(s=setTimeout(v,o)),l}return o=toNumber(o)||0,isObject(e)&&(f=!!e.leading,d="maxWait"in e,a=d?nativeMax(toNumber(e.maxWait)||0,o):a,t="trailing"in e?!!e.trailing:t),m.cancel=function(){void 0!==s&&clearTimeout(s),r=u=i=s=void(c=0)},m.flush=function(){return void 0===s?l:p(now())},m}function throttle(e,t,o){var n=!0,r=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT);return isObject(o)&&(n="leading"in o?!!o.leading:n,r="trailing"in o?!!o.trailing:r),debounce(e,t,{leading:n,maxWait:t,trailing:r})}function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function isObjectLike(e){return!!e&&"object"==typeof e}function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&objectToString.call(e)==symbolTag}function toNumber(e){if("number"==typeof e)return e;if(isSymbol(e))return NAN;if("string"!=typeof(e=isObject(e)?isObject(t="function"==typeof e.valueOf?e.valueOf():e)?t+"":t:e))return 0===e?e:+e;e=e.replace(reTrim,"");var t=reIsBinary.test(e);return t||reIsOctal.test(e)?freeParseInt(e.slice(2),t?2:8):reIsBadHex.test(e)?NAN:+e}var lodash_throttle=throttle,build={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return!("undefined"==typeof window||!("ontouchstart"in window||window.DocumentTouch&&"undefined"!=typeof document&&document instanceof window.DocumentTouch))||!("undefined"==typeof navigator||!navigator.maxTouchPoints&&!navigator.msMaxTouchPoints)},e.exports=t.default}(build,build.exports);var isTouchDevice=getDefaultExportFromCjs(build.exports),defaultOptions={debug:!1,maxDisplays:99999,exitIntentThrottle:200,eventThrottle:200,showAfterInactiveSecondsDesktop:60,showAfterInactiveSecondsMobile:40,showAgainAfterSeconds:10,enableOnInactivityDesktop:!0,enableOnInactivityMobile:!0,enableOnMouseleaveDesktop:!0,enableOnBlurMobile:!1,enableOnScrollBottomMobile:!1,scrollBottomOffset:200,enableOnScrollTopMobile:!1,onExitIntent:function(e){alert("onExitIntent action - "+e)}},isDesktop=!isTouchDevice(),target=isDesktop?document.body:window,resetTimeoutTriggersDesktop=["scroll","mousemove","wheel"],resetTimeoutTriggersMobile=["touchstart","touchend","touchmove"];function ExitIntent(e){function t(){if(l.debug){for(var e,t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];(e=console).log.apply(e,["[exit-intent-debug]"].concat(o))}}var o,n,r,i,a,l=_extends({},defaultOptions,e=void 0===e?{}:e),s=0,u=[],c=isDesktop?l.enableOnInactivityDesktop:l.enableOnInactivityMobile,f=isDesktop?l.showAfterInactiveSecondsDesktop:l.showAfterInactiveSecondsMobile,e=isDesktop?resetTimeoutTriggersDesktop:resetTimeoutTriggersMobile,d=lodash_throttle(function(e){s<l.maxDisplays&&(t("trigger successtul (after cooldown time)",s+=1),l.onExitIntent(e),s>=l.maxDisplays&&v())},1e3*l.showAgainAfterSeconds,{trailing:!1});isDesktop?l.enableOnMouseleaveDesktop&&(t("register mouseleave trigger for desktop"),n=lodash_throttle(function(e){e instanceof MouseEvent&&(t("mouseleave trigger"),d())},l.exitIntentThrottle),target.addEventListener("mouseleave",n,!1),u.push({event:"mouseleave",handler:n,target:target})):(l.enableOnBlurMobile&&(t("register on blur trigger for mobile"),n=lodash_throttle(function(){t("blur trigger"),d()},l.exitIntentThrottle),target.addEventListener("blur",n,!1),u.push({event:"blur",handler:n,target:target})),l.enableOnScrollBottomMobile&&(a=lodash_throttle(function(){setTimeout(function(){var e=document.body.scrollHeight;window.innerHeight+window.scrollY+l.scrollBottomOffset>=e&&(t("scroll to bottom trigger"),d())},50)},l.eventThrottle),target.addEventListener("scroll",a,!1),u.push({event:"scroll",handler:a,target:target})),l.enableOnScrollTopMobile&&(r=document.body.scrollHeight/2,i=0,a=function(e){window.innerHeight+window.scrollY>r&&(i=e.timeStamp)},b=function(e){setTimeout(function(){window.scrollY<100&&e.timeStamp-i<2e3&&(t("fast scroll to top trigger"),d())},100)},target.addEventListener("touchstart",a,!1),target.addEventListener("touchend",b,!1),u.push({event:"touchstart",handler:a,target:target}),u.push({event:"touchend",handler:b,target:target})));var b=function(){c&&void 0===f?t("exit intent trigger by inactivity is disabled"):(void 0!==o&&(t("clear inactivity timeout"),window.clearTimeout(o)),o=window.setTimeout(function(){t("exit intent trigger by inactivity after "+f+"s"),d()},1e3*f))},g=lodash_throttle(b,l.eventThrottle);e.forEach(function(e){t("registering event for restartTimer",{event:e,target:target}),target.addEventListener(e,g,!1),u.push({event:e,handler:g,target:target})});var v=function(){t("cleanup after "+s+" displays"),void 0!==o&&window.clearTimeout(o),u.forEach(function(e){var t=e.event,o=e.handler;e.target.removeEventListener(t,o)})};return b(),v}export default ExitIntent;
